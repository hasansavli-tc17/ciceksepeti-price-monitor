{
  "name": "Ã‡iÃ§ek Sepeti Fiyat Takip",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 9
            }
          ]
        }
      },
      "name": "Her GÃ¼n Saat 9'da",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [250, 300],
      "id": "schedule-trigger"
    },
    {
      "parameters": {
        "command": "=cd ~/n8n-tazecicek && node scraper.js"
      },
      "name": "Fiyat Scraper Ã‡alÄ±ÅŸtÄ±r",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [450, 300],
      "id": "execute-scraper"
    },
    {
      "parameters": {
        "jsCode": "// Scraper'dan gelen verileri iÅŸle\nconst scrapedData = JSON.parse($input.first().json.stdout);\nconst products = scrapedData.products;\n\n// Ã–nceki fiyatlarÄ± kontrol et (n8n'in Static Data'sÄ±ndan)\nconst oldPrices = $('Static Data').first().json;\nconst changes = [];\n\nfor (const product of products) {\n  const oldPrice = oldPrices[product.id];\n  \n  if (oldPrice && oldPrice !== product.price) {\n    changes.push({\n      name: product.name,\n      oldPrice: oldPrice,\n      newPrice: product.price,\n      change: product.price - oldPrice,\n      url: product.url\n    });\n  }\n  \n  // Yeni fiyatÄ± kaydet\n  oldPrices[product.id] = product.price;\n}\n\nreturn {\n  json: {\n    changes: changes,\n    allProducts: products,\n    updatedPrices: oldPrices\n  }\n};"
      },
      "name": "Fiyat KarÅŸÄ±laÅŸtÄ±r",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [650, 300],
      "id": "compare-prices"
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$json.changes.length}}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "name": "DeÄŸiÅŸiklik Var mÄ±?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [850, 300],
      "id": "if-changes"
    },
    {
      "parameters": {
        "authentication": "webhook",
        "url": "https://hooks.slack.com/services/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",
        "options": {},
        "bodyParametersJson": "={\n  \"text\": \"ğŸŒ¸ *Ã‡iÃ§ek Sepeti Fiyat DeÄŸiÅŸiklikleri*\",\n  \"blocks\": [\n    {\n      \"type\": \"header\",\n      \"text\": {\n        \"type\": \"plain_text\",\n        \"text\": \"ğŸŒ¸ Ã‡iÃ§ek Sepeti Fiyat GÃ¼ncellemesi\"\n      }\n    },\n    {\n      \"type\": \"section\",\n      \"text\": {\n        \"type\": \"mrkdwn\",\n        \"text\": \"*{{$json.changes.length}} Ã¼rÃ¼nÃ¼n fiyatÄ± deÄŸiÅŸti!*\\n\\n\" + {{$json.changes.map(c => `*${c.name}*\\nâ€¢ Eski: ${c.oldPrice}â‚º\\nâ€¢ Yeni: ${c.newPrice}â‚º\\nâ€¢ Fark: ${c.change > 0 ? 'ğŸ“ˆ +' : 'ğŸ“‰ '}${c.change}â‚º\\n<${c.url}|ÃœrÃ¼ne Git>\\n`).join('\\n')}}\n      }\n    }\n  ]\n}"
      },
      "name": "Slack Bildirimi GÃ¶nder",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1050, 250],
      "id": "slack-notify"
    },
    {
      "parameters": {
        "dataPropertyName": "data",
        "options": {}
      },
      "name": "Static Data - Fiyat DB",
      "type": "n8n-nodes-base.set",
      "typeVersion": 1,
      "position": [650, 450],
      "id": "static-data"
    }
  ],
  "connections": {
    "Her GÃ¼n Saat 9'da": {
      "main": [
        [
          {
            "node": "Fiyat Scraper Ã‡alÄ±ÅŸtÄ±r",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fiyat Scraper Ã‡alÄ±ÅŸtÄ±r": {
      "main": [
        [
          {
            "node": "Fiyat KarÅŸÄ±laÅŸtÄ±r",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fiyat KarÅŸÄ±laÅŸtÄ±r": {
      "main": [
        [
          {
            "node": "DeÄŸiÅŸiklik Var mÄ±?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DeÄŸiÅŸiklik Var mÄ±?": {
      "main": [
        [
          {
            "node": "Slack Bildirimi GÃ¶nder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-10-11T00:00:00.000Z",
  "versionId": "1"
}

